<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.cars_management.Controller.Contracts.ContractController" stylesheets="@../Style/contract.css">
    <top>
        <VBox style="-fx-background-color: #2c3e50; -fx-padding: 15;">
            <Label text="Gestion des Contrats de Location" style="-fx-font-size: 24; -fx-text-fill: white; -fx-font-weight: bold;"/>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true">
            <VBox spacing="15" style="-fx-padding: 20;">
                <!-- Client Information Section -->
                <TitledPane text="Informations Client" animated="false">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Nom du Client"/>
                                <TextField fx:id="tfClientName" promptText="Nom complet"/>
                            </VBox>
                            <VBox prefWidth="300">
                                <Label text="CNI / Passeport"/>
                                <TextField fx:id="tfClientCNI" promptText="Numéro CNI ou passeport"/>
                            </VBox>
                        </HBox>
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Téléphone"/>
                                <TextField fx:id="tfClientPhone" promptText="Numéro de téléphone"/>
                            </VBox>
                            <VBox prefWidth="300">
                                <Label text="Adresse"/>
                                <TextField fx:id="tfClientAddress" promptText="Adresse complète"/>
                            </VBox>
                        </HBox>
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Date du Permis de Conduire"/>
                                <DatePicker fx:id="dpDriverLicenseDate"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </TitledPane>

                <!-- Vehicle Information Section -->
                <TitledPane text="Informations du Véhicule" animated="false">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Marque"/>
                                <TextField fx:id="tfCarBrand" promptText="Marque du véhicule"/>
                            </VBox>
                            <VBox prefWidth="300">
                                <Label text="Modèle"/>
                                <TextField fx:id="tfCarModel" promptText="Modèle du véhicule"/>
                            </VBox>
                        </HBox>
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Plaque d'Immatriculation"/>
                                <TextField fx:id="tfCarPlate" promptText="Numéro de plaque"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </TitledPane>

                <!-- Rental Information Section -->
                <TitledPane text="Informations de Location" animated="false">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Date de Début"/>
                                <DatePicker fx:id="dpRentalStartDate"/>
                            </VBox>
                            <VBox prefWidth="300">
                                <Label text="Date de Fin"/>
                                <DatePicker fx:id="dpRentalEndDate"/>
                            </VBox>
                        </HBox>
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Nombre de Jours"/>
                                <TextField fx:id="tfRentalDays" promptText="Calculé automatiquement" editable="false"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </TitledPane>

                <!-- Price Calculation Section -->
                <TitledPane text="Calcul du Prix" animated="false">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="20">
                            <VBox prefWidth="300">
                                <Label text="Prix par Jour"/>
                                <TextField fx:id="tfPricePerDay" promptText="Prix par jour (€)"/>
                            </VBox>
                            <VBox prefWidth="300">
                                <Label text="Prix Total"/>
                                <TextField fx:id="tfTotalPrice" promptText="Calculé automatiquement" editable="false" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </TitledPane>

                <!-- Hidden ID field -->
                <HBox style="-fx-padding: 0; -fx-spacing: 0;">
                    <TextField fx:id="tfId" managed="false" visible="false"/>
                </HBox>

                <!-- Action Buttons -->
                <HBox spacing="10" style="-fx-padding: 10;">
                    <Button text="Ajouter" onAction="#addContract" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-padding: 10; -fx-font-size: 14;"/>
                    <Button text="Modifier" onAction="#updateContract" style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-padding: 10; -fx-font-size: 14;"/>
                    <Button text="Supprimer" onAction="#deleteContract" style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-padding: 10; -fx-font-size: 14;"/>
                    <Button text="Retour" onAction="#handleRetoure" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-padding: 10; -fx-font-size: 14;"/>
                </HBox>

                <!-- Table Section -->
                <TitledPane text="Contrats Enregistrés" animated="false">
                    <VBox style="-fx-padding: 10;">
                        <TableView fx:id="contractTable" prefHeight="300" onMouseClicked="#onTableRowClick">
                            <columns>
                                <TableColumn fx:id="colId" text="ID" prefWidth="40"/>
                                <TableColumn fx:id="colClientName" text="Client" prefWidth="120"/>
                                <TableColumn fx:id="colCarPlate" text="Plaque" prefWidth="100"/>
                                <TableColumn fx:id="colStartDate" text="Début" prefWidth="100"/>
                                <TableColumn fx:id="colEndDate" text="Fin" prefWidth="100"/>
                                <TableColumn fx:id="colTotalPrice" text="Prix Total" prefWidth="100"/>
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                            </columnResizePolicy>
                        </TableView>
                    </VBox>
                </TitledPane>
            </VBox>
        </ScrollPane>
    </center>

</BorderPane>
